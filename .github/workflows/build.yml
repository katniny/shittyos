name: Build ShittyOS # does GitHub care about swearing?

on:
  push:
    branches:
      - main
    workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
      
      - name: Install NASM
        run: sudo apt-get update && sudo apt-get install -y nasm
      
      - name: Assemble ShittyOS
        run: nasm -f bin theentirething.asm -o shittyos.img

      - name: Release
        uses: softprops/action-gh-release@v1
        continue-on-error: true
        id: attempt-1
        with:
          name: "ShittyOS v${{ github.run_number }}"
          tag_name: nightly
          body: "Shitty OS release v${{ github.run_number }}! A .img file is provided for your convience of not having to install one program and run one command. Prepare to be underwhelmed whether you run this on real hardware or in a VM."
          token: ${{ secrets.GITHUB_TOKEN }}
          files: |
            shittyos.img